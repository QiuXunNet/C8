@using C8.Lottery.Model
@using C8.Lottery.Public
@using System.Configuration
@model LotteryType

@{
    Layout = null;
    int lType = ViewBag.lType;
    var socketUrl = ConfigurationManager.AppSettings["WebSocketUrl"];
    string CityId = ViewBag.CityId;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>@Model.SeoSubject</title>
    <meta name="keywords" content="@Model.SeoKeyword">
    <meta name="description" content="@Model.SeoDescription">
    <link rel="stylesheet" type="text/css" href="~/css/dialog.css" />
    <link rel="stylesheet" type="text/css" href="~/css/style.css" />
    <link rel="stylesheet" type="text/css" href="~/css/c8-icon.css" />
    <script type="text/javascript" src="~/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="~/js/dialog.min.js"></script>
    <script type="text/javascript" src="~/js/yjp.js"></script>

    <script type="text/javascript" src="/js/baidu-statistics.js"></script>
    <script type="text/javascript" src="~/js/runTime2.js"></script>
</head>

<body style="background:#F4F4F5;">

    <header class="hjc_header">
        <a href="javascript:history.go(-1)" class="hjc_back"></a>
        <a href="javascript:;" class="hjc_logo  hjc_HeaderXL">@Model.TypeName<span class="select_sign"></span></a>
        <a href="javascript:;" class="ZX_Sidebar"></a>
    </header>

    <div class="hjc_hdNav fixed" style="display:none">
        <input type="hidden" id="lType" value="@lType" />
        <div class="hdNav_cai_expand">
            <ul class="hdNav_cai"></ul>
            <div style="clear: both;"></div>
        </div>
    </div>

    <div class="Plan_content top50">
        <div class="Plan_CInfo">
            <div class="CZ_hdtit">
                <dl class="CZ_hdMain info_LHC">
                    <dt><a href="javascript:;"><img src="/images/logo5.png"></a></dt>
                    <dd>
                        <div class="hdM_ddtit">
                            <h3 class="hdM_ddtqi f-l">
                                第<span id="txtIssue">@ViewBag.lastIssue</span>期
                            </h3>
                            <p class="hdM_ddtime f-r">
                                下期开奖：@Html.Raw(ViewBag.time)  
                            </p>
                            <div style="clear:both;"></div>
                        </div>
                        <div class="Forecast_LHC" id="ballListDiv"></div>
                        <div class="Forecast_LHC" id="shengXiaoListDiv"></div>
                    </dd>
                </dl>
            </div>
        </div>
    </div>

    <div class="info_LHC_nav">
        <ul class="hdNav_ul">
            <li>
                <a href="/Record/OpenRecord/?lType=@lType">
                    <i><img src="/images/icon_info_01.png"></i>
                    <p>开奖</p>
                </a>
            </li>
            <li>
                <a href="/News/Index/5/123">
                    <i><img src="/images/icon_info_02.png"></i>
                    <p>挂牌</p>
                </a>
            </li>
            <li>
                <a href="/News/Index/5/124">
                    <i><img src="/images/icon_info_03.png"></i>
                    <p>跑狗</p>
                </a>
            </li>
            <li>
                <a href="@Url.Action("LotteryTime","News")">
                    <i><img src="/images/icon_info_04.png"></i>
                    <p>时间</p>
                </a>
            </li>
        </ul>
        <div style="clear:both;"></div>
    </div>

    <div class="info_LHC_category col4">
        <dl>
            <dt><p><span class="spec"></span>香港正版图库</p></dt>
            <dd><a href="/News/Index/5/111">看图解码</a></dd>
            <dd><a href="/News/Index/5/112">幸运彩图</a></dd>
            <dd><a href="/News/Index/5/113">精选彩图</a></dd>
            <dd><a href="/News/Index/5/114">香港图库</a></dd>
        </dl>
        <div class="clearfix"></div>
    </div>

    <div class="info_LHC_category col3">
        <dl id="newsTypeListDiv">
            <dt>
                <p>
                    <span class="spec"></span>免费资料
                </p>
            </dt>
        </dl>
        <div class="clearfix"></div>
    </div>

    <!--侧边栏-->
    <div class="ZX_CLBox">
        <div class="CLB_YY"></div>
        <div class="CLB_con">
            <ul class="CLB_cNav">
                <!--cNav_current-->
                <li>
                    <a href="/Home/Index">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/w6_1.png"></dt>
                            <dd>
                                <p>首页</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
                <li>
                    <a href="/Home/Open">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/w6_2.png"></dt>
                            <dd>
                                <p>开奖</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
                @*<li>
                        <a href="JavaScript:;">
                            <dl class="cNav_Dl">
                                <dt><img src="/images/w6_4.png"></dt>
                                <dd>
                                    <p>走势</p>
                                    <img src="/images/w7.png">
                                    <div style="clear:both;"></div>
                                </dd>
                            </dl>
                        </a>
                    </li>*@
                <li>
                    <a href="/Home/Plan">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/w6_3.png"></dt>
                            <dd>
                                <p>计划</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
                <li>
                    <a href="/List/Index">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/grids_icon_04.png"></dt>
                            <dd>
                                <p>排行</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
                <li>
                    <a href="/Talking/Index">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/w6_5.png"></dt>
                            <dd>
                                <p>聊天</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
                <li>
                    <a href="/List/Expert">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/grids_icon_06.png"></dt>
                            <dd>
                                <p>高手</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
                <li>
                    <a href="/News/Index/2">
                        <dl class="cNav_Dl">
                            <dt><img src="/images/grids_icon_07.png"></dt>
                            <dd>
                                <p>资讯</p>
                                <img src="/images/w7.png">
                                <div style="clear:both;"></div>
                            </dd>
                        </dl>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="mask" style="display:none;"></div>
    <div class="mask2" style="display:none;"></div>

    <script type="text/javascript">
        var newsTypeList = eval("@ViewBag.NewsTypeList".replace(/&quot;/g, "'"));
        var lastNum = "@ViewBag.lastNum";
        var showInfo = "@ViewBag.showInfo";
        var lotteryTypeList = eval("@ViewBag.LotteryTypeList".replace(/&quot;/g, "'"));

        var lotteryTypeListHtml = "";
        $(lotteryTypeList).each(function () {
            if (this.Id == 5) {
                lotteryTypeListHtml += "<li class='current' data-id='" + this.Id + "'><a href='/News/TypeIndex/" + this.Id + "'>" + this.TypeName + "</a></li>"
            }
            else {
                lotteryTypeListHtml += "<li data-id='" + this.Id + "'><a href='/News/Index/" + this.Id + "'>" + this.TypeName + "</a></li>"
            }
        });
        $(".hdNav_cai").empty().append(lotteryTypeListHtml);


        var showInfoHtml = "";
        $(showInfo.split(',')).each(function (i) {
            if (this.length > 0) {
                if (i == showInfo.split(',').length - 1) {
                    showInfoHtml += "<span class='LHC_spAjia'>+</span>";
                }
                showInfoHtml += "<span class='LHC_spA'>"+this+"</span>"
            }
        });
        $("#shengXiaoListDiv").empty().append(showInfoHtml);


        var lastNumHtml = "";
        $(lastNum.split(',')).each(function (i) {
            if (this.length > 0) {
                if (i == lastNum.split(',').length - 1) {
                    lastNumHtml += "<span class='LHC_spAjia'>+</span>";
                }
                lastNumHtml += "<span class='LHC_spA " + getColor(this)+"'>"+this+"</span>"
            }
        });
        $("#ballListDiv").empty().append(lastNumHtml);


        var newsTypeListHtml = "";
        $(newsTypeList).each(function () {
            newsTypeListHtml += "<dd><a href='/News/Index/" + this.LType + "/" + this.Id + "'>" + this.TypeName+"</a></dd>";
        });
        $("#newsTypeListDiv").append(newsTypeListHtml);

    </script>

    @*实时开奖*@
    <script type="text/javascript">
        var url = "@socketUrl/LhcHandler.ashx";
        var ws;
        $(function () {
            ws = new WebSocket(url);

            //链接成功回调
            ws.onopen = function () {
                wsOnopen();
            }
            //收到消息回调
            ws.onmessage = function (evt) {
                wsOnmessage(evt);
            }
            //链接失败回调
            ws.onerror = function (evt) {
            }
            //链接关闭回调
            ws.onclose = function () {
                wsOnclose()
            }
        });

        //链接成功回调
        function wsOnopen() {

        }

        //收到消息回调
        function wsOnmessage(evt) {
            var msg = evt.data;
            var data = eval("(" + msg + ")");
            if (data == undefined || data == null)
                return;
            switch (data.MsgTypeChild) {
                case 11: //开始命令
                    break;
                case 12: //结束命令
                    ws.close()  //结束后，主动断开链接
                    break;
                case 21: //消息
                    showBall(data);
                    break;
                case 31: //心跳包

                    break;
            }
        }

        //链接关闭回调
        function wsOnclose() {

        }

        //显示球
        function showBall(data) {
            if (data.IsPeriod == 1) { // 如果是期数消息
                $("#txtIssue").text(data.Content);
                $("#ballListDiv,#shengXiaoListDiv").empty();
            } else {
                if (data.IsTM == 1) {//如果是特码
                    $("#ballListDiv,#shengXiaoListDiv").append('<span class="LHC_spAjia">+</span>&nbsp;');
                }
                var num = (data.Content.length < 2) ? "0" + data.Content : data.Content;
                $("#ballListDiv").append('<span class="LHC_spA ' + getColor(num) + '">' + num + '</span>&nbsp;');
                console.log(data.SubTime);
                $("#shengXiaoListDiv").append('<span class="LHC_spA">' + getShengXiao(data.Content) +'</span>&nbsp;');
            }
        }
    </script>

    @*广告位*@
    <script type="text/javascript">
        $(function () {
            var location = -1;
            getadlist(location);
        });

          //广告位
        function getadlist(location) {
            $.get("/News/GetAdvertisementListJson",
                {
                    location: location,
                    adtype: 3
                },
               function (data) {
                   if (data.Success == true) {
                       inadHtml(data.data);
                   } 
               });
        }

        function inadHtml(data) {
            var cityid=@CityId;
            var city;
            var idx=-1;
            $.each(data, function (index, item)
            {
                if(item.RestrictedAreas!=null && item.RestrictedAreas!="")
                {
                    city=item.RestrictedAreas.split(',');
                    idx=$.inArray(cityid.toString(),city);
                }
                if(item.RestrictedAreas==null ||item.RestrictedAreas=="" || idx==-1)
                {
                    if(!IsPC())
                    {
                        if (item.Layer == 1) {
                            $(".Plan_content").prepend(itemhtml(item))
                        } else if (item.Layer == 2) {
                            $(".Plan_content").after(itemhtml(item))
                        } else if (item.Layer == 3) {
                            $(".info_LHC_nav").after(itemhtml(item))
                        }
                        else if (item.Layer == 4) {
                            $(".col4").after(itemhtml(item))
                        }
                        else if (item.Layer == 5) {
                            $(".col3").after(itemhtml(item))
                        }
                        else if (item.Layer == 6) {
                            //$(".hjc_news_lhs").after(itemhtml(item))
                            //$(".GG_Box").addClass("GG_Box1")

                        } else if (item.Layer == 7) {
                            //$(".raking").after(itemhtml(item))
                            //$(".GG_Box").addClass("GG_Box1")
                        }
                    }
                }
            });
        }
        function itemhtml(item) {
            var html = '';
            if (item.ThumbStyle == 0) {
                html = '<div class="GG_Box  GG_Box1 GG_Box2">'
                    + '<a href="' + item.TransferUrl + '">'
                    + '<h3 class="GG_B1Tit">' + item.Title + '</h3>'
                    + '</a>'
                    + '</div>';

            } else if (item.ThumbStyle == 1) {
                var img = '';
                if (item.ThumbList != null && item.ThumbList.length > 0) {
                    img = '<img src="' + item.ThumbList[0] + '">'
                }

                html = '<div class="GG_Box GG_Box1">'
                    + '<a href="' + item.TransferUrl + '">'
                    + '<div class="GG_B2Left f-l">'
                    + '<h3 class="GG_B1Tit">' + item.Title + '</h3>'
                    + '</div>'
                    + '<div class="GG_B2Right">' + img + '</div>'
                    + '</a>'
                    + '</div>';

            } else if (item.ThumbStyle == 2) {
                var img = '';
                if (item.ThumbList != null && item.ThumbList.length > 0) {
                    img = '<img src="' + item.ThumbList[0] + '">'
                }
                html = '<div class="GG_Box GG_Box1">'
                    + '<a href="' + item.TransferUrl + '">'
                    + '<h3 class="GG_B1Tit">' + item.Title + '</h3>'
                    + '<div class="GG_B4Tu">' + img + '</div>'
                    + '</a>'
                    + '</div>';

            } else if (item.ThumbStyle == 3) {
                var img = '';
                if (item.ThumbList != null && item.ThumbList.length > 0) {
                    for (var i = 0; i < item.ThumbList.length; i++) {
                        img += '<li><img src="' + item.ThumbList[i] + '"></li>'
                    }
                }

                html = '<div class="GG_Box GG_Box1">'
                    + '<a href="' + item.TransferUrl + '">'
                    + '<h3 class="GG_B1Tit">' + item.Title + '</h3>'
                    + '<ul class="GG_B3Tu">'
                    + img
                    + '<div style="clear:both;"></div>'
                    + '</ul>'
                    + '</a>'
                    + '</div>';
            } else if (item.ThumbStyle == 4) {
                var img = '';
                if (item.ThumbList != null && item.ThumbList.length > 0) {
                    img = '<img src="' + item.ThumbList[0] + '"  class="GG_B5Tu">'
                }
                html = '  <div class="GG_Box GG_Box1 PD3">'
                    + ' <a href="' + item.TransferUrl + '">' + img + '</a>'
                    + '   </div>';
            }
            return html;
        }
    </script>

</body>
@{Html.RenderAction("index", "PvUvIp");}
</html>
